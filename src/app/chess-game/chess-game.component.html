<div class="w-screen h-screen flex flex-col items-center justify-center bg-app-background text-text-primary overflow-hidden transition-colors duration-300">
  @if (chessService.gameInitialized()) {
  <!-- Layout móvil -->
  <div
    class="w-full max-w-4xl flex flex-col gap-1 items-center justify-center px-2 py-2 md:hidden h-full overflow-auto">
    <app-header-game class="w-full shrink-0" [currentTurn]="chessService.currentTurn()"
      [totalMovements]="chessService.totalMovements()" [whiteCaptures]="chessService.whiteCaptures()"
      [blackCaptures]="chessService.blackCaptures()" [scoreHistory]="chessService.scoreHistory()"
      [(aiEnabled)]="chessService.aiEnabled" [(isDarkMode)]="chessService.isDarkMode" [aiThinking]="chessService.isAiThinking()"
      [whiteInCheck]="chessService.whiteInCheck()" [blackInCheck]="chessService.blackInCheck()"
      [checkmateWarning]="chessService.checkmateWarning()" [onReset]="onReset.bind(this)"
      (clearHistory)="chessService.clearScoreHistory()" />


    <div class="w-full flex-1 flex justify-center items-center min-h-0">
      <div class="aspect-square w-full max-w-sm flex items-center justify-center">
        <app-chess-board class="w-full h-full" [board]="chessService.board()" [currentTurn]="chessService.currentTurn()"
          [gameOver]="chessService.gameOver()" [animate]="chessService.showInitialAnimations()" [validateMove]="validateMove.bind(this)"
          (moveAttempt)="onMoveAttempt($event)" />
      </div>
    </div>

  </div>

  <!-- Layout escritorio -->
  <div class="hidden md:flex w-full h-full gap-4 px-4 py-4">
    <!-- Header vertical a la izquierda -->
    <div class="w-64 shrink-0 border-r-2 border-slate-300 dark:border-gray-700 pr-4">
      <div class="bg-slate-50 dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 h-full">
        <app-header-game class="w-full h-full" [currentTurn]="chessService.currentTurn()"
          [totalMovements]="chessService.totalMovements()" [whiteCaptures]="chessService.whiteCaptures()"
          [blackCaptures]="chessService.blackCaptures()" [scoreHistory]="chessService.scoreHistory()"
          [(aiEnabled)]="chessService.aiEnabled" [(isDarkMode)]="chessService.isDarkMode" [aiThinking]="chessService.isAiThinking()"
          [whiteInCheck]="chessService.whiteInCheck()" [blackInCheck]="chessService.blackInCheck()"
          [checkmateWarning]="chessService.checkmateWarning()" [onReset]="onReset.bind(this)" [isVertical]="true"
          (clearHistory)="chessService.clearScoreHistory()" />
      </div>
    </div>

    <!-- Tablero en el centro -->
    <div class="flex-1 flex items-center justify-center px-8">
      <div class="aspect-square w-full max-w-3xl bg-white dark:bg-gray-800 rounded-lg shadow-lg border-2 border-slate-200 dark:border-gray-700 p-4">
        <app-chess-board class="w-full h-full" [board]="chessService.board()" [currentTurn]="chessService.currentTurn()"
          [gameOver]="chessService.gameOver()" [animate]="chessService.showInitialAnimations()" [validateMove]="validateMove.bind(this)"
          (moveAttempt)="onMoveAttempt($event)" />
      </div>
    </div>

    <!-- Historial vertical a la derecha -->
    <div class="w-64 shrink-0 border-l-2 border-slate-300 dark:border-gray-700 pl-4">
      <div class="bg-slate-50 dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 h-full">
        <app-history-game class="w-full h-full" [moveHistory]="chessService.moveHistory()" [isVertical]="true" />
      </div>
    </div>
  </div>
  }

  @if (chessService.victoryModalData().open) {
  <app-modal-game [modalData]="chessService.victoryModalData()"
    (closeModal)="chessService.showVictoryModal.set(false)" />
  }

  <!-- Modal de confirmación de jaque mate -->
  @if (chessService.checkmateConfirmModal().show) {
  <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>
    
    <!-- Contenido del modal -->
    <div class="relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in-0 zoom-in-95 duration-200">
      <!-- Header -->
      <div class="flex items-center gap-3 mb-4">
        <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center">
          <svg class="w-6 h-6 text-orange-600 dark:text-orange-400" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13 16h-1v-4h-1m1-4h.01M21 12c0 4.9706-4.0294 9-9 9s-9-4.0294-9-9 4.0294-9 9-9 9 4.0294 9 9z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div>
          <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">⚠️ Movimiento Peligroso</h3>
          <p class="text-sm text-gray-600 dark:text-gray-400">Este movimiento te deja vulnerable</p>
        </div>
      </div>
      
      <!-- Contenido -->
      <div class="mb-6">
        <p class="text-gray-700 dark:text-gray-300 leading-relaxed">
          El movimiento que intentas hacer permitirá que las <strong>negras (IA) puedan hacer jaque mate</strong> en su próximo turno.
        </p>
        <p class="text-gray-600 dark:text-gray-400 text-sm mt-2">
          ¿Estás seguro de que quieres hacer este movimiento arriesgado?
        </p>
      </div>
      
      <!-- Botones -->
      <div class="flex gap-3">
        <button (click)="onCancelCheckmate()" 
                class="flex-1 px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg font-medium transition-colors duration-200">
          No, elegir otro movimiento
        </button>
        <button (click)="onConfirmCheckmate()" 
                class="flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors duration-200">
          Sí, asumir el riesgo
        </button>
      </div>
    </div>
  </div>
  }
</div>