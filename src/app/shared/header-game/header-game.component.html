<div [class.flex-col]="isVertical()" [class.h-full]="isVertical()"
  class="flex flex-col gap-6 p-8 bg-white/60 dark:bg-gunmetal/60 backdrop-blur-2xl border border-app-muted/20 rounded-[2.5rem] shadow-2xl transition-all duration-300">

  <!-- Top Navigation -->
  <div class="flex items-center justify-between px-1">
    <button (click)="goHome()"
      class="flex items-center gap-2 text-[10px] font-black text-text-muted hover:text-app-accent uppercase tracking-[0.2em] transition-colors group">
      <svg class="w-4 h-4 transform group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor"
        viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      Volver
    </button>
    <div class="flex gap-1">
      <div class="w-1 h-1 rounded-full bg-app-accent opacity-40"></div>
      <div class="w-1 h-1 rounded-full bg-app-accent opacity-20"></div>
    </div>
  </div>

  <!-- Turn Status Section -->
  <div class="flex flex-col gap-4">
    <div class="flex items-center justify-between px-1">
      <h3 class="text-xs font-black text-text-muted uppercase tracking-[0.2em]">Estado de Turno</h3>
      @if (aiThinking() && aiEnabled()) {
      <div class="flex gap-1.5">
        <div class="w-1.5 h-1.5 bg-app-accent rounded-full animate-bounce"></div>
        <div class="w-1.5 h-1.5 bg-app-accent rounded-full animate-bounce [animation-delay:0.2s]"></div>
        <div class="w-1.5 h-1.5 bg-app-accent rounded-full animate-bounce [animation-delay:0.4s]"></div>
      </div>
      }
    </div>

    <div [class.bg-white]="currentTurn() === PieceColor.White" [class.bg-gunmetal]="currentTurn() === PieceColor.Black"
      class="relative group h-20 rounded-3xl flex items-center justify-center border-2 border-app-muted/10 shadow-xl transition-all duration-500 overflow-hidden">

      <div
        class="absolute inset-x-0 bottom-0 h-1.5 bg-app-accent transform transition-transform duration-500 scale-x-100 opacity-60">
      </div>

      <div class="flex items-center gap-4 z-10">
        <div [class.bg-gunmetal]="currentTurn() === PieceColor.White"
          [class.bg-white]="currentTurn() === PieceColor.Black"
          class="w-10 h-10 rounded-full border-2 border-app-muted/20 shadow-inner flex items-center justify-center transform group-hover:scale-110 transition-transform">
          <div [class.bg-white]="currentTurn() === PieceColor.White"
            [class.bg-gunmetal]="currentTurn() === PieceColor.Black" class="w-4 h-4 rounded-full"></div>
        </div>
        <span [class.text-gunmetal]="currentTurn() === PieceColor.White"
          [class.text-white]="currentTurn() === PieceColor.Black"
          class="text-2xl font-black tracking-tighter uppercase italic">
          {{ currentTurn() === PieceColor.White ? 'Blancas' : 'Negras' }}
        </span>
      </div>
    </div>
  </div>

  <!-- Stats Section -->
  <div class="flex-1 flex flex-col gap-4" [class.justify-center]="isVertical()">
    <p class="text-[10px] font-black text-text-muted/50 uppercase tracking-[0.3em] px-1" [class.hidden]="!isVertical()">
      Estadísticas</p>

    <div class="grid gap-3" [class.grid-cols-3]="!isVertical()" [class.grid-cols-1]="isVertical()">
      <!-- Moves -->
      <div
        class="bg-app-background/20 dark:bg-app-background/5 p-5 rounded-2xl border border-app-muted/10 group hover:border-app-accent/40 transition-all flex flex-col items-center justify-center text-center">
        <div class="text-[10px] font-black text-text-muted uppercase tracking-widest mb-1 opacity-70">Movimientos</div>
        <div class="text-3xl font-black text-text-primary">{{ totalMovements() }}</div>
      </div>
      <!-- White Captures -->
      <div
        class="bg-white/80 dark:bg-gunmetal/40 p-5 rounded-2xl border border-app-muted/10 group hover:border-app-accent/40 transition-all flex flex-col items-center justify-center text-center">
        <div class="text-[10px] font-black text-text-muted uppercase tracking-widest mb-1 opacity-70">Capturas B</div>
        <div class="text-3xl font-black text-app-accent">{{ whiteCaptures() }}</div>
      </div>
      <!-- Black Captures -->
      <div
        class="bg-gunmetal/90 dark:bg-white/5 p-5 rounded-2xl border border-app-muted/10 group hover:border-app-accent/40 transition-all flex flex-col items-center justify-center text-center">
        <div
          class="text-[10px] font-black text-white/40 dark:text-text-muted uppercase tracking-widest mb-1 opacity-70">
          Capturas N</div>
        <div class="text-3xl font-black text-white dark:text-text-primary">{{ blackCaptures() }}</div>
      </div>
    </div>
  </div>

  <!-- AI & Actions Section -->
  <div class="flex flex-col gap-3" [class.mt-auto]="isVertical()">
    <button (click)="onToggleAi()" [class.bg-app-accent]="aiEnabled()" [class.text-gunmetal]="aiEnabled()"
      [class.bg-white/40]="!aiEnabled()" [class.text-text-muted]="!aiEnabled()"
      class="w-full flex items-center justify-between px-6 py-4 rounded-2xl border border-app-muted/10 font-black text-[11px] uppercase tracking-widest transition-all hover:scale-[1.02] active:scale-95 shadow-lg shadow-black/5">
      <span class="flex items-center gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
          </path>
        </svg>
        Oponente IA
      </span>
      <div class="w-10 h-5 bg-black/10 rounded-full relative">
        <div [class.translate-x-5]="aiEnabled()"
          class="absolute left-0 top-0 w-5 h-5 bg-current rounded-full transition-transform border border-black/5 shadow-sm">
        </div>
      </div>
    </button>

    <button (click)="handleReset()"
      class="w-full flex items-center justify-center gap-3 px-6 py-4 bg-gunmetal dark:bg-app-accent text-white dark:text-gunmetal rounded-2xl font-black text-xs uppercase tracking-[0.2em] transition-all hover:opacity-90 hover:shadow-xl hover:shadow-gunmetal/20 active:scale-95">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
          d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
        </path>
      </svg>
      Reiniciar Juego
    </button>
  </div>

  <!-- Notification Banners -->
  @if (bannerState() !== 'hidden') {
  <div class="mt-4 animate-in slide-in-from-top duration-300">
    @if (checkmateWarning().show) {
    <div class="flex items-center gap-3 p-5 bg-red-600 text-white rounded-2xl shadow-xl shadow-red-500/20">
      <svg class="w-6 h-6 shrink-0 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
        </path>
      </svg>
      <span class="text-[11px] font-black uppercase tracking-tight leading-4">{{ checkmateWarning().message }}</span>
    </div>
    } @else if (checkWarning().show) {
    <div [class.bg-orange-600]="checkProminent()" [class.bg-orange-500/90]="!checkProminent()"
      class="flex items-center gap-3 p-5 text-white rounded-2xl shadow-xl shadow-orange-500/20">
      <svg class="w-6 h-6 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M13 16h-1v-4h-1m1-4h.01M21 12c0 4.9706-4.0294 9-9 9s-9-4.0294-9-9 4.0294-9 9-9 9 4.0294 9 9z"></path>
      </svg>
      <div class="flex flex-col">
        <span class="text-[11px] font-black uppercase tracking-tight">{{ checkWarning().text }}</span>
        @if (checkProminent()) {
        <span class="text-[9px] font-bold opacity-80 uppercase tracking-widest mt-1">¡Defiende a tu rey!</span>
        }
      </div>
    </div>
    }
  </div>
  }
</div>